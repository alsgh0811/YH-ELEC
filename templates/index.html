<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ìì¬ ì¬ê³  ê´€ë¦¬</title>
</head>
<body>

    {% if session.get("role") == "admin" %}
    <a href="/admin/users">ğŸ‘¤ ì‚¬ìš©ì ê´€ë¦¬</a>
    {% endif %}

    {% if error == "not_enough" %}
    <p style="color:red;">
        âŒ ì¶œê³  ìˆ˜ëŸ‰ì´ í˜„ì¬ ì¬ê³ ë³´ë‹¤ ë§ìŠµë‹ˆë‹¤.
    </p>
    {% endif %}

    {% if session.role == "admin" %}
    <a href="/admin/users">ğŸ‘‘ ê´€ë¦¬ì ìŠ¹ì¸ í˜ì´ì§€</a>
    {% endif %}

    {% if session.get("user_id") %}
    <p>
        ë¡œê·¸ì¸ ì¤‘ ({{ session.get("role") }})
        |
        <a href="/logout">ë¡œê·¸ì•„ì›ƒ</a>
    </p>
    {% endif %}

    <h1>ìì¬ ì¬ê³  ëª©ë¡</h1>

    <form method="get" action="/">
    <input type="text" name="name" placeholder="ìì¬ëª… ê²€ìƒ‰"
           value="{{ request.args.get('name', '') }}">

    <input type="text" name="spec" placeholder="ê·œê²© ê²€ìƒ‰"
           value="{{ request.args.get('spec', '') }}">

    <button type="submit">ğŸ” ê²€ìƒ‰</button>

    <a href="/">ì „ì²´ë³´ê¸°</a>
    </form>

<br>

    <a href="/add_item">â• ì‹ ê·œ ìì¬ ë“±ë¡</a>
    <a href="/upload_csv">ğŸ“ CSV ìì¬ ë“±ë¡</a>
    <a href="/history">ğŸ“„ ì…Â·ì¶œê³  ì´ë ¥ ë³´ê¸°</a>

    <br><br>

    <table border="1" cellpadding="5">
        <tr>
            <th>ìì¬ëª…</th>
            <th>ê·œê²©</th>
            <th>í˜„ì¬ìˆ˜ëŸ‰</th>
            <th>ìœ„ì¹˜</th>
            <th>ì…Â·ì¶œê³ </th>
            <th>ê´€ë¦¬</th>
        </tr>

        {% for item in items %}
        <tr>
            <td>{{ item.name }}</td>
            <td>{{ item.spec }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.location }}</td>
            <td>
                <form action="/update/{{ item.id }}" method="post">
                    <select name="type">
                        <option value="IN">ì…ê³ </option>
                        <option value="OUT">ì¶œê³ </option>
                    </select>

                    <input type="number" name="quantity" min="1" required>
                    <input type="text" name="manager" placeholder="ë‹´ë‹¹ì" required>

                    <button type="submit">ì²˜ë¦¬</button>
                </form>
            </td>

            <td>
                <a href="/edit_item/{{ item.id }}">ìˆ˜ì •</a>

                {% if item.quantity == 0 %}
                | <a href="/delete_item/{{ item.id }}"
                     onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
                    ì‚­ì œ
                  </a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>

</body>
</html>
